<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guardar y Abrir Archivos ¬∑ T3 ¬∑ M√≥dulo 3 ¬∑ Uni Academy</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
  :root{
    --cyan:#00f5e4;--gold:#ffd93d;--green:#00e676;--red:#ff3d3d;
    --orange:#ff8c00;--teal:#14b8a6;--emerald:#10b981;--blue:#3b82f6;
    --bg:#060b18;--card:#111d35;--text:#e8f4ff;--muted:#6a8aaa;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--bg);color:var(--text);font-family:'Exo 2',sans-serif;min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;
    background:radial-gradient(ellipse at 20% 40%,rgba(20,184,166,.07) 0%,transparent 55%),
               radial-gradient(ellipse at 80% 20%,rgba(16,185,129,.04) 0%,transparent 55%);
    pointer-events:none;z-index:0;}
  body::after{content:'';position:fixed;inset:0;
    background-image:linear-gradient(rgba(20,184,166,.016) 1px,transparent 1px),
      linear-gradient(90deg,rgba(20,184,166,.016) 1px,transparent 1px);
    background-size:55px 55px;pointer-events:none;z-index:0;}

  .header{position:relative;z-index:10;display:flex;align-items:center;
    justify-content:space-between;padding:14px 32px;
    border-bottom:1px solid rgba(20,184,166,.15);
    background:rgba(6,11,24,.94);backdrop-filter:blur(14px);}
  .logo{display:flex;align-items:center;gap:12px;}
  .logo-badge{width:40px;height:40px;background:linear-gradient(135deg,var(--teal),var(--emerald));
    clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);
    display:flex;align-items:center;justify-content:center;
    font-family:'Orbitron',monospace;font-size:9px;font-weight:900;color:#fff;}
  .logo-text{font-family:'Orbitron',monospace;font-size:13px;font-weight:700;color:var(--teal);letter-spacing:2px;}
  .logo-sub{font-size:9px;color:var(--muted);letter-spacing:1px;}
  .header-module{font-family:'Orbitron',monospace;font-size:10px;color:var(--teal);
    letter-spacing:2px;border:1px solid var(--teal);padding:4px 14px;border-radius:2px;background:rgba(20,184,166,.06);}

  .container{position:relative;z-index:5;max-width:960px;margin:0 auto;padding:22px 18px 60px;}

  /* UNI */
  .uni-bar{display:flex;align-items:center;gap:18px;background:var(--card);
    border:1px solid rgba(20,184,166,.22);border-radius:16px;padding:15px 20px;
    margin-bottom:18px;position:relative;overflow:hidden;}
  .uni-bar::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
    background:linear-gradient(90deg,var(--teal),var(--emerald),var(--cyan),var(--teal));}
  .uni-svg{width:58px;height:58px;flex-shrink:0;}
  .speech{background:rgba(20,184,166,.05);border:1px solid rgba(20,184,166,.22);
    border-radius:12px;padding:10px 16px;flex:1;position:relative;}
  .speech::before{content:'';position:absolute;left:-10px;top:50%;transform:translateY(-50%);
    border:5px solid transparent;border-right-color:rgba(20,184,166,.22);}
  .uni-name{font-family:'Orbitron',monospace;font-size:9px;color:var(--teal);letter-spacing:2px;margin-bottom:4px;}
  .speech p{font-size:14px;line-height:1.5;}
  .speech strong{color:var(--emerald);}

  /* PHASE TABS */
  .phase-row{display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap;}
  .phase-tab{font-family:'Orbitron',monospace;font-size:8px;letter-spacing:1px;
    padding:6px 14px;border-radius:8px;border:1px solid;cursor:default;transition:all .3s;}
  .phase-tab.done  {color:var(--green);border-color:rgba(0,230,118,.3);background:rgba(0,230,118,.07);}
  .phase-tab.active{color:var(--teal); border-color:var(--teal); background:rgba(20,184,166,.12);
    box-shadow:0 0 14px rgba(20,184,166,.25);}
  .phase-tab.pending{color:var(--muted);border-color:rgba(255,255,255,.08);background:transparent;}

  /* STEP INDICATOR */
  .step-bar{display:flex;align-items:center;gap:10px;margin-bottom:16px;}
  .step-dots{display:flex;gap:5px;}
  .sdot{width:10px;height:10px;border-radius:50%;transition:all .3s;
    background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.15);}
  .sdot.done{background:var(--green);border-color:var(--green);}
  .sdot.cur {background:var(--teal); border-color:var(--teal); transform:scale(1.4);}
  .step-label{font-family:'Orbitron',monospace;font-size:10px;color:var(--muted);}
  .step-label span{color:var(--teal);font-weight:700;}

  /* SCREEN SIMULATION */
  .sim-wrap{background:var(--card);border:1.5px solid rgba(20,184,166,.2);border-radius:20px;
    overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.55);margin-bottom:16px;}
  .sim-topbar{height:4px;background:linear-gradient(90deg,var(--teal),var(--emerald),var(--cyan));}
  .sim-label{font-family:'Orbitron',monospace;font-size:8px;letter-spacing:3px;color:var(--teal);
    padding:8px 16px 6px;border-bottom:1px solid rgba(20,184,166,.1);}
  .sim-body{padding:0;position:relative;min-height:320px;}

  /* WORD WINDOW */
  .word-window{background:#0f1828;border-radius:0;}
  .word-titlebar{background:#0b1422;padding:6px 12px;display:flex;align-items:center;gap:8px;border-bottom:1px solid rgba(255,255,255,.06);}
  .win-btns{display:flex;gap:5px;}
  .win-btn{width:11px;height:11px;border-radius:50%;}
  .win-title{font-size:11px;color:rgba(255,255,255,.45);margin-left:6px;}
  .word-ribbon{background:#0d1a2e;padding:5px 10px;display:flex;gap:8px;align-items:center;border-bottom:1px solid rgba(255,255,255,.06);}
  .ribbon-tab{font-size:10px;color:rgba(255,255,255,.35);padding:3px 8px;cursor:pointer;border-radius:3px;transition:all .15s;}
  .ribbon-tab:hover,.ribbon-tab.active-tab{background:rgba(20,184,166,.15);color:var(--teal);}
  .ribbon-tab.highlight{background:rgba(20,184,166,.25)!important;color:var(--teal)!important;
    border:1px solid rgba(20,184,166,.5);animation:ribbonPulse 1s ease-in-out infinite;}
  @keyframes ribbonPulse{0%,100%{box-shadow:0 0 0 0 rgba(20,184,166,0)}50%{box-shadow:0 0 0 6px rgba(20,184,166,.15)}}
  .word-doc{padding:20px 30px;background:#f8f9fa;min-height:180px;position:relative;}
  .doc-lines{display:flex;flex-direction:column;gap:6px;}
  .doc-line{height:4px;border-radius:2px;background:#d0d0d0;}
  .doc-text{font-family:Georgia,serif;font-size:13px;color:#222;line-height:1.8;}
  .cursor-blink{display:inline-block;width:2px;height:14px;background:#222;
    animation:blink .7s ease-in-out infinite;vertical-align:middle;margin-left:1px;}
  @keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
  .word-statusbar{background:#0a1422;padding:4px 12px;font-size:9px;color:rgba(255,255,255,.3);
    display:flex;justify-content:space-between;border-top:1px solid rgba(255,255,255,.05);}

  /* SAVE AS DIALOG */
  .dialog{background:#0f1a2e;border:1px solid rgba(20,184,166,.3);border-radius:12px;
    box-shadow:0 20px 60px rgba(0,0,0,.8);overflow:hidden;width:94%;max-width:560px;
    margin:16px auto;}
  .dialog-title{background:#0a1422;padding:10px 16px;font-size:12px;font-weight:600;
    display:flex;align-items:center;gap:8px;border-bottom:1px solid rgba(255,255,255,.07);}
  .dialog-body{padding:16px;}
  .dialog-row{display:flex;align-items:center;gap:10px;margin-bottom:12px;}
  .dialog-label{font-size:11px;color:rgba(255,255,255,.5);width:100px;flex-shrink:0;}
  .dialog-field{flex:1;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.12);
    border-radius:6px;padding:6px 10px;font-size:12px;color:rgba(255,255,255,.85);
    font-family:'Exo 2',sans-serif;outline:none;transition:border-color .15s;}
  .dialog-field:focus{border-color:var(--teal);}
  .dialog-field.highlight{border-color:var(--teal)!important;box-shadow:0 0 12px rgba(20,184,166,.3);
    animation:fieldPulse 1s ease-in-out infinite;}
  @keyframes fieldPulse{0%,100%{box-shadow:0 0 8px rgba(20,184,166,.2)}50%{box-shadow:0 0 18px rgba(20,184,166,.4)}}
  .folder-nav{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap;}
  .fnav-item{padding:5px 12px;border-radius:8px;font-size:10px;cursor:pointer;
    border:1.5px solid;transition:all .15s;}
  .fnav-item:hover{transform:translateY(-1px);}
  .fnav-item.selected{border-color:var(--teal)!important;background:rgba(20,184,166,.15)!important;color:var(--teal)!important;}
  .fnav-item.highlight{animation:navPulse 1s ease-in-out infinite;}
  @keyframes navPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,217,61,0)}50%{box-shadow:0 0 0 6px rgba(255,217,61,.2)}}
  .dialog-btns{display:flex;gap:8px;justify-content:flex-end;margin-top:14px;}
  .dbtn{padding:7px 20px;border-radius:8px;font-size:11px;font-family:'Exo 2',sans-serif;
    cursor:pointer;border:none;font-weight:600;transition:all .15s;}
  .dbtn.cancel{background:rgba(255,255,255,.07);color:rgba(255,255,255,.6);}
  .dbtn.save{background:linear-gradient(135deg,var(--teal),var(--emerald));color:#fff;}
  .dbtn.save:hover{opacity:.85;}
  .dbtn.save.highlight{animation:btnPulse 1s ease-in-out infinite;}
  @keyframes btnPulse{0%,100%{box-shadow:0 0 0 0 rgba(20,184,166,0)}50%{box-shadow:0 0 0 8px rgba(20,184,166,.2)}}
  .dbtn:disabled{opacity:.35;cursor:not-allowed;}

  /* EXPLORER OPEN */
  .file-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:10px;padding:14px;}
  .file-item{background:rgba(255,255,255,.04);border:1.5px solid rgba(255,255,255,.08);
    border-radius:10px;padding:10px 6px;text-align:center;cursor:pointer;transition:all .15s;}
  .file-item:hover{border-color:var(--teal);background:rgba(20,184,166,.1);}
  .file-item.target-file{border-color:var(--teal)!important;background:rgba(20,184,166,.12)!important;
    animation:filePulse 1s ease-in-out infinite;}
  @keyframes filePulse{0%,100%{box-shadow:0 0 0 0 rgba(20,184,166,0)}50%{box-shadow:0 0 0 8px rgba(20,184,166,.15)}}
  .file-item.target-file.dblclicked{border-color:var(--green)!important;background:rgba(0,230,118,.12)!important;}
  .fi-icon{font-size:28px;margin-bottom:4px;}
  .fi-name{font-size:9px;color:rgba(255,255,255,.6);word-break:break-word;line-height:1.3;}

  /* ACTION BUTTON */
  .action-wrap{padding:14px 16px;border-top:1px solid rgba(20,184,166,.1);}
  .btn-action{width:100%;padding:12px;background:linear-gradient(135deg,var(--teal),var(--emerald));
    color:#fff;border:none;border-radius:12px;font-family:'Orbitron',monospace;font-size:12px;
    font-weight:700;letter-spacing:2px;cursor:pointer;transition:opacity .18s,transform .18s;
    box-shadow:0 4px 16px rgba(20,184,166,.3);}
  .btn-action:hover{opacity:.85;transform:translateY(-1px);}
  .btn-action:disabled{opacity:.3;cursor:not-allowed;transform:none;}

  /* SUCCESS FLASH */
  .step-success{background:rgba(0,230,118,.08);border:1px solid rgba(0,230,118,.2);
    border-radius:12px;padding:12px 16px;margin-bottom:12px;
    font-size:13px;color:var(--green);display:none;animation:fadeIn .3s ease;}
  .step-success.show{display:block;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:none}}

  /* FINAL RESULT */
  .final-result{display:none;background:var(--card);border-radius:20px;overflow:hidden;
    box-shadow:0 24px 70px rgba(0,0,0,.55);}
  .final-result.visible{display:block;}
  .fr-top{height:5px;background:linear-gradient(90deg,var(--teal),var(--emerald),var(--cyan));}
  .fr-body{padding:36px 24px;text-align:center;}
  .fr-stars{font-size:48px;letter-spacing:8px;animation:starPop .6s cubic-bezier(.34,1.56,.64,1) both;}
  @keyframes starPop{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
  .fr-title{font-family:'Orbitron',monospace;font-size:22px;font-weight:900;
    background:linear-gradient(135deg,var(--teal),var(--emerald));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:8px 0 4px;}
  .fr-sub{font-family:'Orbitron',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;margin-bottom:20px;}
  .fr-msg{font-size:15px;line-height:1.7;max-width:540px;margin:0 auto 24px;color:rgba(255,255,255,.8);}
  .fr-msg strong{color:var(--emerald);}
  .skills-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px;margin-bottom:24px;}
  .skill-card{background:rgba(20,184,166,.07);border:1px solid rgba(20,184,166,.2);
    border-radius:12px;padding:14px 10px;text-align:center;}
  .sk-icon{font-size:28px;margin-bottom:5px;}
  .sk-name{font-family:'Orbitron',monospace;font-size:8px;color:var(--teal);letter-spacing:1px;margin-bottom:3px;}
  .sk-desc{font-size:11px;color:var(--muted);line-height:1.4;}
  .btn-restart{padding:13px 32px;background:linear-gradient(135deg,var(--teal),var(--emerald));
    color:#fff;border:none;border-radius:12px;font-family:'Orbitron',monospace;font-size:12px;
    font-weight:700;letter-spacing:2px;cursor:pointer;transition:opacity .2s,transform .2s;
    box-shadow:0 6px 20px rgba(20,184,166,.3);}
  .btn-restart:hover{opacity:.88;transform:translateY(-2px);}

  /* Confetti */
  @keyframes conf{0%{transform:translate(0,0) rotate(0);opacity:1}100%{transform:translate(var(--tx),var(--ty)) rotate(var(--r));opacity:0}}
  .conf{position:fixed;width:9px;height:9px;border-radius:2px;pointer-events:none;animation:conf .85s ease-out forwards;z-index:999;}

  @media(max-width:640px){
    .header{padding:10px 14px;}
    .container{padding:10px 8px 40px;}
    .uni-bar{flex-direction:column;align-items:flex-start;}
    .speech::before{display:none;}
    .phase-row{gap:4px;}
    .phase-tab{font-size:7px;padding:4px 10px;}
  }
</style>
</head>
<body>

<header class="header">
  <div class="logo">
    <div class="logo-badge">UNi</div>
    <div><div class="logo-text">UNI ACADEMY</div><div class="logo-sub">MI PRIMER CURSO DE COMPUTACI√ìN</div></div>
  </div>
  <div class="header-module">M√ìDULO 3 ¬∑ T3 ¬∑ T4 ¬∑ T5</div>
</header>

<div class="container">

  <!-- UNI -->
  <div class="uni-bar">
    <svg class="uni-svg" viewBox="0 0 80 90" fill="none">
      <ellipse cx="40" cy="75" rx="22" ry="6" fill="rgba(20,184,166,.13)"/>
      <rect x="27" y="68" width="10" height="14" rx="4" fill="#1a2a4a"/>
      <rect x="43" y="68" width="10" height="14" rx="4" fill="#1a2a4a"/>
      <rect x="25" y="78" width="14" height="6" rx="3" fill="#243355"/>
      <rect x="41" y="78" width="14" height="6" rx="3" fill="#243355"/>
      <rect x="20" y="42" width="40" height="30" rx="10" fill="#1e2d4f"/>
      <rect x="20" y="42" width="40" height="30" rx="10" stroke="#14b8a6" stroke-width="1.5" stroke-opacity=".5"/>
      <circle cx="40" cy="57" r="5" fill="#14b8a6"/>
      <circle cx="40" cy="57" r="3" fill="#fff" fill-opacity=".5"/>
      <rect x="8" y="44" width="13" height="8" rx="4" fill="#1a2a4a"/>
      <rect x="59" y="44" width="13" height="8" rx="4" fill="#1a2a4a"/>
      <circle cx="10" cy="56" r="5" fill="#243355"/>
      <circle cx="70" cy="56" r="5" fill="#243355"/>
      <rect x="33" y="35" width="14" height="9" rx="4" fill="#1a2a4a"/>
      <rect x="15" y="10" width="50" height="30" rx="14" fill="#1e2d4f"/>
      <rect x="15" y="10" width="50" height="30" rx="14" stroke="#14b8a6" stroke-width="1.5" stroke-opacity=".55"/>
      <rect x="20" y="16" width="40" height="18" rx="8" fill="#060b18"/>
      <circle cx="32" cy="25" r="5" fill="#14b8a6"/>
      <circle cx="32" cy="25" r="3" fill="#fff" fill-opacity=".5"/>
      <circle cx="48" cy="25" r="5" fill="#10b981"/>
      <circle cx="48" cy="25" r="3" fill="#fff" fill-opacity=".6"/>
      <rect x="38" y="3" width="4" height="9" rx="2" fill="#243355"/>
      <circle cx="40" cy="3" r="3" fill="#14b8a6"/>
      <rect x="10" y="18" width="6" height="14" rx="3" fill="#243355"/>
      <rect x="64" y="18" width="6" height="14" rx="3" fill="#243355"/>
    </svg>
    <div class="speech">
      <div class="uni-name">// UNI ¬∑ GU√çA DIGITAL</div>
      <p id="uniMsg">¬°Hola, Explorador! üíæ Vamos a aprender a <strong>guardar</strong> y <strong>abrir</strong> archivos paso a paso. Sigue mis instrucciones y haz clic en lo que te pido. ¬°Empecemos!</p>
    </div>
  </div>

  <!-- PHASE TABS -->
  <div class="phase-row" id="phaseRow">
    <div class="phase-tab active" id="ptab-1">üìù T3 ¬∑ ESCRIBIR</div>
    <div class="phase-tab pending" id="ptab-2">üíæ T4 ¬∑ GUARDAR</div>
    <div class="phase-tab pending" id="ptab-3">üìÇ T5 ¬∑ ABRIR</div>
  </div>

  <!-- STEP INDICATOR -->
  <div class="step-bar">
    <div class="step-dots" id="stepDots"></div>
    <div class="step-label">Paso <span id="stepNum">1</span> de <span id="stepTotal">9</span></div>
  </div>

  <!-- SUCCESS FLASH -->
  <div class="step-success" id="stepSuccess">‚úÖ ¬°Correcto! Avanzando al siguiente paso‚Ä¶</div>

  <!-- SIM AREA -->
  <div class="sim-wrap" id="simWrap">
    <div class="sim-topbar"></div>
    <div class="sim-label" id="simLabel">// SIMULACI√ìN ¬∑ MICROSOFT WORD</div>
    <div class="sim-body" id="simBody"></div>
    <div class="action-wrap" id="actionWrap">
      <button class="btn-action" id="btnAction" onclick="doAction()">SIGUIENTE PASO ‚Üí</button>
    </div>
  </div>

  <!-- FINAL RESULT -->
  <div class="final-result" id="finalResult">
    <div class="fr-top"></div>
    <div class="fr-body">
      <div class="fr-stars">‚≠ê‚≠ê‚≠ê</div>
      <div class="fr-title">¬°M√ìDULO 3 CASI COMPLETO!</div>
      <div class="fr-sub">T3 ¬∑ T4 ¬∑ T5 COMPLETADOS</div>
      <div class="fr-msg">¬°Fant√°stico, Explorador! üöÄ Ya sabes <strong>escribir</strong>, <strong>guardar</strong> y <strong>abrir</strong> archivos en tu computadora. ¬°Estas son las habilidades m√°s importantes para organizar tu trabajo!</div>
      <div class="skills-grid">
        <div class="skill-card"><div class="sk-icon">üìù</div><div class="sk-name">ESCRIBIR</div><div class="sk-desc">Abriste Word y escribiste texto</div></div>
        <div class="skill-card"><div class="sk-icon">üíæ</div><div class="sk-name">GUARDAR COMO</div><div class="sk-desc">Elegiste carpeta, nombre y guardaste</div></div>
        <div class="skill-card"><div class="sk-icon">üìÇ</div><div class="sk-name">ABRIR ARCHIVO</div><div class="sk-desc">Encontraste y abriste el archivo guardado</div></div>
      </div>
      <button class="btn-restart" onclick="restart()">üîÑ &nbsp;PRACTICAR DE NUEVO</button>
    </div>
  </div>

</div>

<script>
// ‚ïê‚ïê STEPS DEFINITION ‚ïê‚ïê
const STEPS = [
  // PHASE 1 ‚Äî ESCRIBIR
  { phase:1, id:'open-word',
    label:'Abrir Microsoft Word',
    uni:'üìù Primero necesitamos <strong>abrir Microsoft Word</strong>. Haz doble clic en el √≠cono de Word en el escritorio.',
    simLabel:'// ESCRITORIO DE WINDOWS',
    render: renderDesktop,
    action:'dblclick-word' },

  { phase:1, id:'type-text',
    label:'Escribir una frase',
    uni:'‚úçÔ∏è ¬°Word est√° abierto! Ahora <strong>escribe algo</strong> en el documento. Haz clic en el bot√≥n para escribir la frase de pr√°ctica.',
    simLabel:'// MICROSOFT WORD ¬∑ DOCUMENTO NUEVO',
    render: renderWordBlank,
    action:'type' },

  // PHASE 2 ‚Äî GUARDAR
  { phase:2, id:'click-archivo',
    label:'Hacer clic en "Archivo"',
    uni:'üíæ ¬°Perfecto! Ahora vamos a <strong>guardar</strong> lo que escribiste. Haz clic en la pesta√±a <strong>"Archivo"</strong> en la barra de men√∫.',
    simLabel:'// MICROSOFT WORD ¬∑ CON TEXTO',
    render: renderWordWithText,
    action:'click-archivo' },

  { phase:2, id:'click-guardar-como',
    label:'Seleccionar "Guardar como‚Ä¶"',
    uni:'üìÇ ¬°Bien! Ahora busca y haz clic en <strong>"Guardar como‚Ä¶"</strong> para guardar el archivo por primera vez.',
    simLabel:'// MICROSOFT WORD ¬∑ MEN√ö ARCHIVO',
    render: renderMenuArchivo,
    action:'click-guardar-como' },

  { phase:2, id:'choose-folder',
    label:'Elegir la carpeta de destino',
    uni:'üìÅ Ahora elige <strong>d√≥nde guardar</strong> tu archivo. Haz clic en la carpeta <strong>"Mis Documentos"</strong> para guardar ah√≠.',
    simLabel:'// CUADRO DE DI√ÅLOGO ¬∑ GUARDAR COMO',
    render: renderSaveDialog1,
    action:'choose-folder' },

  { phase:2, id:'write-filename',
    label:'Escribir el nombre del archivo',
    uni:'‚úèÔ∏è ¬°Carpeta elegida! Ahora escribe el <strong>nombre del archivo</strong>. Haz clic en el campo de nombre y escribe "Mi primera tarea".',
    simLabel:'// CUADRO DE DI√ÅLOGO ¬∑ GUARDAR COMO',
    render: renderSaveDialog2,
    action:'write-name' },

  { phase:2, id:'click-save',
    label:'Hacer clic en "Guardar"',
    uni:'üíæ ¬°Nombre listo! Ahora haz clic en el bot√≥n <strong>"Guardar"</strong> para guardar el archivo definitivamente.',
    simLabel:'// CUADRO DE DI√ÅLOGO ¬∑ GUARDAR COMO',
    render: renderSaveDialog3,
    action:'click-save' },

  // PHASE 3 ‚Äî ABRIR
  { phase:3, id:'open-explorer',
    label:'Abrir el Explorador de Archivos',
    uni:'üìÇ ¬°Archivo guardado! üéâ Ahora vamos a <strong>abrirlo</strong>. Haz clic en el √≠cono del Explorador de Archivos en la barra de tareas.',
    simLabel:'// ESCRITORIO ¬∑ BARRA DE TAREAS',
    render: renderDesktopSaved,
    action:'open-explorer' },

  { phase:3, id:'open-file',
    label:'Hacer doble clic en el archivo',
    uni:'üéØ ¬°Casi! Encontraste la carpeta "Mis Documentos". Ahora <strong>haz doble clic</strong> en tu archivo <strong>"Mi primera tarea.docx"</strong> para abrirlo.',
    simLabel:'// EXPLORADOR ¬∑ MIS DOCUMENTOS',
    render: renderExplorer,
    action:'dblclick-file' },
];

const TOTAL = STEPS.length;
let stepIdx = 0;

function init(){
  stepIdx = 0;
  document.getElementById('simWrap').style.display = 'block';
  document.getElementById('finalResult').classList.remove('visible');
  buildDots();
  updatePhases();
  renderStep();
}

function buildDots(){
  document.getElementById('stepTotal').textContent = TOTAL;
  const dots = document.getElementById('stepDots');
  dots.innerHTML = '';
  for(let i=0;i<TOTAL;i++){
    const d=document.createElement('div');d.className='sdot'+(i===0?' cur':'');
    d.id='sdot-'+i;dots.appendChild(d);
  }
}

function updateDots(){
  for(let i=0;i<TOTAL;i++){
    const d=document.getElementById('sdot-'+i);if(!d)return;
    d.className='sdot'+(i<stepIdx?'done':i===stepIdx?'cur':'');
  }
  document.getElementById('stepNum').textContent = stepIdx+1;
}

function updatePhases(){
  const cur = stepIdx < STEPS.length ? STEPS[stepIdx].phase : 4;
  [1,2,3].forEach(p=>{
    const t=document.getElementById('ptab-'+p);if(!t)return;
    const done = p < cur;
    const active = p === cur;
    t.className='phase-tab '+(done?'done':active?'active':'pending');
  });
}

function renderStep(){
  if(stepIdx >= STEPS.length){ showFinal(); return; }
  const s = STEPS[stepIdx];
  document.getElementById('uniMsg').innerHTML = s.uni;
  document.getElementById('simLabel').textContent = s.simLabel;
  document.getElementById('stepSuccess').classList.remove('show');
  document.getElementById('btnAction').disabled = true;
  updateDots(); updatePhases();
  s.render(document.getElementById('simBody'));
}

function advance(){
  const s = document.getElementById('stepSuccess');
  s.textContent = '‚úÖ ¬°Correcto! '+( stepIdx < STEPS.length-1 ? 'Avanzando al siguiente paso‚Ä¶' : '¬°Actividad completada!');
  s.classList.add('show');
  spawnConf();
  setTimeout(()=>{
    stepIdx++;
    s.classList.remove('show');
    if(stepIdx >= STEPS.length) showFinal();
    else renderStep();
  }, 900);
}

function doAction(){
  // Generic fallback ‚Äî shouldn't normally be called
  advance();
}

// ‚ïê‚ïê RENDERS ‚ïê‚ïê

function renderDesktop(body){
  body.innerHTML = `
    <div style="background:linear-gradient(135deg,#0a1628 0%,#160a3a 100%);min-height:280px;padding:20px;position:relative;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;gap:10px;">
      <!-- Icons -->
      <div style="display:flex;gap:24px;flex-wrap:wrap;">
        <div id="word-icon" onclick="clickWordIcon()" style="display:flex;flex-direction:column;align-items:center;gap:5px;cursor:pointer;padding:8px;border-radius:10px;border:2px solid rgba(59,130,246,.5);background:rgba(59,130,246,.1);transition:all .15s;animation:filePulse 1s ease-in-out infinite;">
          <div style="font-size:40px;">üìò</div>
          <div style="font-size:10px;color:rgba(255,255,255,.7);font-family:'Exo 2',sans-serif;">Microsoft Word</div>
          <div style="font-size:9px;color:rgba(20,184,166,.8);font-family:'Orbitron',monospace;">DOBLE CLIC ‚Üê</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:center;gap:5px;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.08);">
          <div style="font-size:40px;">üóëÔ∏è</div>
          <div style="font-size:10px;color:rgba(255,255,255,.4);font-family:'Exo 2',sans-serif;">Papelera</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:center;gap:5px;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.08);">
          <div style="font-size:40px;">üñ•Ô∏è</div>
          <div style="font-size:10px;color:rgba(255,255,255,.4);font-family:'Exo 2',sans-serif;">Esta PC</div>
        </div>
      </div>
      <!-- Taskbar -->
      <div style="position:absolute;bottom:0;left:0;right:0;height:36px;background:rgba(8,5,20,.97);border-top:1px solid rgba(20,184,166,.2);display:flex;align-items:center;padding:0 10px;gap:6px;">
        <div style="font-size:18px;">ü™ü</div>
        <div style="font-size:12px;color:rgba(255,255,255,.3);">üîç Buscar</div>
        <div style="margin-left:auto;font-family:'Orbitron',monospace;font-size:9px;color:rgba(255,255,255,.4);">10:30</div>
      </div>
    </div>`;
  let clicks=0,timer=null;
  document.getElementById('word-icon').addEventListener('click',()=>{
    clicks++;
    if(clicks===1){timer=setTimeout(()=>{clicks=0;},600);}
    else{clearTimeout(timer);clicks=0;advance();}
  });
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí HICE DOBLE CLIC EN WORD';
  document.getElementById('btnAction').onclick=advance;
}

function renderWordBlank(body){
  body.innerHTML=`
    <div class="word-window">
      <div class="word-titlebar">
        <div class="win-btns">
          <div class="win-btn" style="background:#ff5f57"></div>
          <div class="win-btn" style="background:#ffbd2e"></div>
          <div class="win-btn" style="background:#28ca41"></div>
        </div>
        <div class="win-title">Documento1 ‚Äî Microsoft Word</div>
      </div>
      <div class="word-ribbon">
        <span class="ribbon-tab">Inicio</span><span class="ribbon-tab">Insertar</span>
        <span class="ribbon-tab">Dise√±o</span><span class="ribbon-tab">Revisar</span>
      </div>
      <div class="word-doc" style="min-height:160px;">
        <div id="typeArea" style="font-family:Georgia,serif;font-size:14px;color:#222;min-height:60px;line-height:1.8;">
          <span class="cursor-blink"></span>
        </div>
      </div>
      <div class="word-statusbar"><span>Palabras: 0</span><span>P√°gina 1 de 1</span></div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚úçÔ∏è ESCRIBIR FRASE DE PR√ÅCTICA';
  document.getElementById('btnAction').onclick=()=>{
    const area=document.getElementById('typeArea');
    area.innerHTML='';
    const txt='Hola, esta es mi primera tarea guardada en la computadora.';
    let i=0;
    const t=setInterval(()=>{
      area.innerHTML=txt.slice(0,i+1)+'<span class="cursor-blink"></span>';
      i++;if(i>=txt.length){clearInterval(t);setTimeout(advance,400);}
    },40);
    document.getElementById('btnAction').disabled=true;
  };
}

function renderWordWithText(body){
  body.innerHTML=`
    <div class="word-window">
      <div class="word-titlebar">
        <div class="win-btns">
          <div class="win-btn" style="background:#ff5f57"></div>
          <div class="win-btn" style="background:#ffbd2e"></div>
          <div class="win-btn" style="background:#28ca41"></div>
        </div>
        <div class="win-title">Documento1 ‚Äî Microsoft Word</div>
      </div>
      <div class="word-ribbon">
        <span class="ribbon-tab highlight" id="tabArchivo" onclick="clickArchivo()">Archivo</span>
        <span class="ribbon-tab">Inicio</span><span class="ribbon-tab">Insertar</span>
        <span class="ribbon-tab">Dise√±o</span>
      </div>
      <div class="word-doc" style="min-height:150px;">
        <div style="font-family:Georgia,serif;font-size:14px;color:#222;line-height:1.8;">
          Hola, esta es mi primera tarea guardada en la computadora.<span class="cursor-blink" style="background:#333;"></span>
        </div>
      </div>
      <div class="word-statusbar"><span>Palabras: 10</span><span>P√°gina 1 de 1</span></div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí HACER CLIC EN "ARCHIVO"';
  document.getElementById('btnAction').onclick=clickArchivo;
}
function clickArchivo(){ advance(); }

function renderMenuArchivo(body){
  body.innerHTML=`
    <div class="word-window">
      <div class="word-titlebar">
        <div class="win-btns">
          <div class="win-btn" style="background:#ff5f57"></div>
          <div class="win-btn" style="background:#ffbd2e"></div>
          <div class="win-btn" style="background:#28ca41"></div>
        </div>
        <div class="win-title">Documento1 ‚Äî Microsoft Word</div>
      </div>
      <div style="display:flex;min-height:200px;">
        <!-- File menu sidebar -->
        <div style="width:200px;background:#0a3040;padding:10px 0;border-right:1px solid rgba(255,255,255,.1);">
          <div style="padding:8px 16px;font-size:12px;color:rgba(255,255,255,.4);cursor:pointer;">Nuevo</div>
          <div style="padding:8px 16px;font-size:12px;color:rgba(255,255,255,.4);cursor:pointer;">Abrir</div>
          <div style="padding:8px 16px;font-size:12px;color:rgba(255,255,255,.4);cursor:pointer;">Guardar &nbsp; Ctrl+S</div>
          <div id="menuGuardarComo" onclick="clickGuardarComo()" style="padding:8px 16px;font-size:12px;cursor:pointer;background:rgba(20,184,166,.2);color:var(--teal);border-left:3px solid var(--teal);font-weight:600;animation:ribbonPulse 1s ease-in-out infinite;">
            üíæ Guardar como‚Ä¶
          </div>
          <div style="padding:8px 16px;font-size:12px;color:rgba(255,255,255,.4);cursor:pointer;">Imprimir</div>
          <div style="padding:8px 16px;font-size:12px;color:rgba(255,255,255,.4);cursor:pointer;">Cerrar</div>
        </div>
        <div style="flex:1;background:#f0f2f5;padding:20px;font-size:13px;color:#555;">
          Informaci√≥n del documento<br><br>
          <span style="font-size:11px;color:#888;">Documento1 ¬∑ No guardado</span>
        </div>
      </div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí HACER CLIC EN "GUARDAR COMO‚Ä¶"';
  document.getElementById('btnAction').onclick=clickGuardarComo;
}
function clickGuardarComo(){ advance(); }

function renderSaveDialog1(body){
  body.innerHTML=`
    <div style="background:#0a1020;padding:16px;min-height:260px;">
      <div class="dialog">
        <div class="dialog-title">üíæ Guardar como</div>
        <div class="dialog-body">
          <div style="margin-bottom:10px;font-size:11px;color:rgba(255,255,255,.5);">Elige d√≥nde guardar tu archivo:</div>
          <div class="folder-nav">
            <div class="fnav-item" style="color:rgba(255,255,255,.4);border-color:rgba(255,255,255,.1);">üñ•Ô∏è Esta PC</div>
            <div class="fnav-item highlight" id="fnav-docs" onclick="chooseFolder()" style="color:var(--gold);border-color:rgba(255,217,61,.4);background:rgba(255,217,61,.07);">üìÅ Mis Documentos ‚Üê</div>
            <div class="fnav-item" style="color:rgba(255,255,255,.4);border-color:rgba(255,255,255,.1);">üñºÔ∏è Im√°genes</div>
            <div class="fnav-item" style="color:rgba(255,255,255,.4);border-color:rgba(255,255,255,.1);">‚¨áÔ∏è Descargas</div>
          </div>
          <div class="dialog-row">
            <div class="dialog-label">Guardar en:</div>
            <div class="dialog-field" id="saveLocation" style="color:rgba(255,255,255,.3);">‚Äî elige una carpeta ‚Äî</div>
          </div>
          <div class="dialog-btns">
            <button class="dbtn cancel">Cancelar</button>
            <button class="dbtn save" id="dlgSave1" disabled>Guardar</button>
          </div>
        </div>
      </div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí ELEGIR "MIS DOCUMENTOS"';
  document.getElementById('btnAction').onclick=chooseFolder;
}
function chooseFolder(){
  document.getElementById('saveLocation').textContent='üìÅ Mis Documentos';
  document.getElementById('saveLocation').style.color='rgba(20,184,166,.9)';
  advance();
}

function renderSaveDialog2(body){
  body.innerHTML=`
    <div style="background:#0a1020;padding:16px;min-height:260px;">
      <div class="dialog">
        <div class="dialog-title">üíæ Guardar como ‚Äî üìÅ Mis Documentos</div>
        <div class="dialog-body">
          <div style="margin-bottom:10px;font-size:11px;color:rgba(255,255,255,.5);">Carpeta seleccionada: <strong style="color:var(--teal)">Mis Documentos</strong> ‚úì</div>
          <div class="dialog-row">
            <div class="dialog-label">Nombre:</div>
            <input class="dialog-field highlight" id="filenameInput" type="text" placeholder='Escribe el nombre aqu√≠‚Ä¶' value="" autocomplete="off"/>
          </div>
          <div class="dialog-row">
            <div class="dialog-label">Tipo:</div>
            <div class="dialog-field" style="color:rgba(255,255,255,.4);">Documento Word (.docx)</div>
          </div>
          <div class="dialog-btns">
            <button class="dbtn cancel">Cancelar</button>
            <button class="dbtn save" id="dlgSave2" disabled onclick="clickSaveName()">Guardar</button>
          </div>
        </div>
      </div>
    </div>`;
  const inp=document.getElementById('filenameInput');
  const btn=document.getElementById('dlgSave2');
  inp.addEventListener('input',()=>{btn.disabled=inp.value.trim().length<2;});
  inp.focus();
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí ESCRIBIR NOMBRE "Mi primera tarea"';
  document.getElementById('btnAction').onclick=()=>{
    inp.value='Mi primera tarea';
    btn.disabled=false;
    advance();
  };
}
function clickSaveName(){
  const v=document.getElementById('filenameInput').value.trim();
  if(v.length>=2) advance();
}

function renderSaveDialog3(body){
  body.innerHTML=`
    <div style="background:#0a1020;padding:16px;min-height:260px;">
      <div class="dialog">
        <div class="dialog-title">üíæ Guardar como ‚Äî üìÅ Mis Documentos</div>
        <div class="dialog-body">
          <div style="margin-bottom:10px;font-size:11px;color:rgba(255,255,255,.5);">Todo listo. ¬°Solo falta guardar!</div>
          <div class="dialog-row">
            <div class="dialog-label">Nombre:</div>
            <div class="dialog-field" style="color:rgba(20,184,166,.9);">Mi primera tarea</div>
          </div>
          <div class="dialog-row">
            <div class="dialog-label">Ubicaci√≥n:</div>
            <div class="dialog-field" style="color:rgba(20,184,166,.9);">üìÅ Mis Documentos</div>
          </div>
          <div class="dialog-row">
            <div class="dialog-label">Tipo:</div>
            <div class="dialog-field" style="color:rgba(255,255,255,.4);">Documento Word (.docx)</div>
          </div>
          <div class="dialog-btns">
            <button class="dbtn cancel">Cancelar</button>
            <button class="dbtn save highlight" id="dlgSaveFinal" onclick="clickFinalSave()">üíæ Guardar</button>
          </div>
        </div>
      </div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí HACER CLIC EN "GUARDAR"';
  document.getElementById('btnAction').onclick=clickFinalSave;
}
function clickFinalSave(){ advance(); }

function renderDesktopSaved(body){
  body.innerHTML=`
    <div style="background:linear-gradient(135deg,#0a1628 0%,#160a3a 100%);min-height:280px;padding:16px;position:relative;">
      <div style="display:flex;gap:20px;flex-wrap:wrap;margin-bottom:8px;">
        <div style="display:flex;flex-direction:column;align-items:center;gap:5px;padding:8px;border-radius:10px;border:1px solid rgba(59,130,246,.3);">
          <div style="font-size:36px;">üìò</div>
          <div style="font-size:9px;color:rgba(255,255,255,.5);font-family:'Exo 2',sans-serif;">Microsoft Word</div>
        </div>
        <div style="display:flex;flex-direction:column;align-items:center;gap:5px;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.08);">
          <div style="font-size:36px;">üñ•Ô∏è</div>
          <div style="font-size:9px;color:rgba(255,255,255,.4);font-family:'Exo 2',sans-serif;">Esta PC</div>
        </div>
      </div>
      <!-- Taskbar with highlighted File Explorer -->
      <div style="position:absolute;bottom:0;left:0;right:0;height:40px;background:rgba(8,5,20,.97);border-top:1px solid rgba(20,184,166,.2);display:flex;align-items:center;padding:0 8px;gap:6px;">
        <div style="font-size:18px;">ü™ü</div>
        <div id="explorerBtn" onclick="clickExplorer()" style="width:36px;height:30px;background:rgba(20,184,166,.2);border-radius:6px;border:1.5px solid rgba(20,184,166,.5);display:flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer;animation:filePulse 1s ease-in-out infinite;">üìÅ</div>
        <div style="font-size:18px;opacity:.5;">üåê</div>
        <div style="font-size:18px;opacity:.5;">üìß</div>
        <div style="margin-left:auto;font-family:'Orbitron',monospace;font-size:9px;color:rgba(255,255,255,.4);">10:35</div>
      </div>
    </div>`;
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí ABRIR EL EXPLORADOR DE ARCHIVOS';
  document.getElementById('btnAction').onclick=clickExplorer;
}
function clickExplorer(){ advance(); }

function renderExplorer(body){
  body.innerHTML=`
    <div style="background:#080f1e;min-height:280px;">
      <!-- Explorer titlebar -->
      <div style="background:#0d1525;padding:6px 12px;display:flex;align-items:center;gap:8px;border-bottom:1px solid rgba(255,255,255,.06);">
        <div style="display:flex;gap:5px;">
          <div style="width:10px;height:10px;border-radius:50%;background:#ff5f57;"></div>
          <div style="width:10px;height:10px;border-radius:50%;background:#ffbd2e;"></div>
          <div style="width:10px;height:10px;border-radius:50%;background:#28ca41;"></div>
        </div>
        <span style="font-size:11px;color:rgba(255,255,255,.45);">üìÅ Mis Documentos ‚Äî Explorador de Archivos</span>
      </div>
      <!-- Address bar -->
      <div style="background:#0b1422;padding:4px 10px;font-size:9px;color:rgba(255,255,255,.3);border-bottom:1px solid rgba(255,255,255,.06);">
        üìÅ Esta PC ‚Ä∫ Documentos ‚Ä∫ Mis Documentos
      </div>
      <!-- Files grid -->
      <div class="file-grid">
        <div style="background:rgba(255,255,255,.03);border:1.5px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 6px;text-align:center;cursor:default;opacity:.5;">
          <div style="font-size:28px;">üìÅ</div>
          <div style="font-size:9px;color:rgba(255,255,255,.4);">Fotos de Familia</div>
        </div>
        <div id="targetFile" class="file-item target-file" onclick="dblClickFile(this)">
          <div class="fi-icon">üìÑ</div>
          <div class="fi-name">Mi primera tarea.docx</div>
          <div style="font-size:8px;color:rgba(20,184,166,.6);font-family:'Orbitron',monospace;margin-top:3px;">DOBLE CLIC ‚Üí</div>
        </div>
        <div style="background:rgba(255,255,255,.03);border:1.5px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 6px;text-align:center;cursor:default;opacity:.5;">
          <div style="font-size:28px;">üìÑ</div>
          <div style="font-size:9px;color:rgba(255,255,255,.4);">Notas.txt</div>
        </div>
        <div style="background:rgba(255,255,255,.03);border:1.5px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 6px;text-align:center;cursor:default;opacity:.5;">
          <div style="font-size:28px;">üìã</div>
          <div style="font-size:9px;color:rgba(255,255,255,.4);">Manual.pdf</div>
        </div>
      </div>
    </div>`;
  let clicks=0,timer=null;
  document.getElementById('targetFile').addEventListener('click',()=>{
    clicks++;
    if(clicks===1){timer=setTimeout(()=>{clicks=0;},600);}
    else{clearTimeout(timer);clicks=0;advance();}
  });
  document.getElementById('btnAction').disabled=false;
  document.getElementById('btnAction').textContent='‚Üí HACER DOBLE CLIC EN MI ARCHIVO';
  document.getElementById('btnAction').onclick=advance;
}
function dblClickFile(el){el.classList.add('dblclicked');setTimeout(advance,300);}

function showFinal(){
  document.getElementById('simWrap').style.display='none';
  document.getElementById('stepSuccess').classList.remove('show');
  document.getElementById('finalResult').classList.add('visible');
  document.getElementById('uniMsg').innerHTML='‚≠ê‚≠ê‚≠ê <strong>¬°Actividad completada!</strong> Ya sabes <strong>escribir</strong>, <strong>guardar</strong> y <strong>abrir</strong> archivos. ¬°Eres un experto en organizaci√≥n digital! üíæ';
  // All dots done
  for(let i=0;i<TOTAL;i++){const d=document.getElementById('sdot-'+i);if(d)d.className='sdot done';}
  [1,2,3].forEach(p=>{const t=document.getElementById('ptab-'+p);if(t)t.className='phase-tab done';});
  setTimeout(bigConf,300);
}

function spawnConf(){
  const colors=['#14b8a6','#10b981','#00e676','#ffd93d','#00f5e4'];
  for(let i=0;i<14;i++){
    const p=document.createElement('div');p.className='conf';
    p.style.cssText=`background:${colors[i%colors.length]};
      left:${25+Math.random()*50}vw;top:${15+Math.random()*25}vh;
      --tx:${(Math.random()-.5)*160}px;--ty:${(Math.random()-.7)*140}px;
      --r:${Math.random()*360}deg;border-radius:${Math.random()>.5?'50%':'2px'};`;
    document.body.appendChild(p);setTimeout(()=>p.remove(),950);
  }
}
function bigConf(){
  const colors=['#14b8a6','#10b981','#00e676','#ffd93d','#a855f7','#00f5e4'];
  for(let i=0;i<55;i++){
    setTimeout(()=>{
      const p=document.createElement('div');p.className='conf';
      p.style.cssText=`background:${colors[i%colors.length]};
        left:${10+Math.random()*80}vw;top:${5+Math.random()*25}vh;
        --tx:${(Math.random()-.5)*280}px;--ty:${80+Math.random()*280}px;
        --r:${Math.random()*720}deg;animation-duration:.9s;
        border-radius:${Math.random()>.5?'50%':'2px'};
        width:${6+Math.random()*8}px;height:${6+Math.random()*8}px;`;
      document.body.appendChild(p);setTimeout(()=>p.remove(),1000);
    },i*28);
  }
}
function restart(){
  document.getElementById('finalResult').classList.remove('visible');
  init();
  window.scrollTo({top:0,behavior:'smooth'});
}
init();
</script>
</body>
</html>
